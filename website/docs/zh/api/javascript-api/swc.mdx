# SWC API

Rspack 支持 JavaScript 的压缩和转换。Rspack 底层使用 SWC 来转换和压缩 JavaScript 代码，你可以使用 `rspack.experiments.swc` API 来访问这些函数。

## 示例

以下是一个简单的示例，演示如何使用 Rspack 转换 JavaScript 代码：

```js
import { rspack } from '@rspack/core';

const swc = rspack.experiments.swc;

swc
  .transform('const a:number = 10;', {
    filename: 'main.ts',
    jsc: {
      parser: {
        syntax: 'typescript',
      },
      target: 'es5',
    },
  })
  .then(result => {
    console.log(result.code);
  });
```

你也可以在 loader 或 plugin 中使用这些 API，来帮助你进行代码转换或压缩。

```js
import { rspack } from '@rspack/core';
const swc = rspack.experiments.swc;

export default async function (content) {
  const customCode = `
    const a = 10;
    const b = 20;
    // custom code
  `;

  const minifiedCode = await swc.minify(customCode, {
    compress: true,
    keep_classnames: true,
    safari10: true,
    sourceMap: true,
  });

  return `${minifiedCode}\n${content}`;
}
```

## 选项

Rspack 底层使用 SWC 来转换和压缩 JavaScript 代码。上述 API 接受的选项会传递给 SWC。

你可以在 SWC 官方文档中了解更多配置选项：

- [SWC Transform API](https://swc.rs/docs/usage/core#transform) - 代码转换选项
- [SWC Minify API](https://swc.rs/docs/usage/core#minify) - 代码压缩选项

```ts
declare namespace rspack {
  namespace experimental {
    declare const swc: {
      transform(
        code: string,
        options?: TransformOptions,
      ): Promise<TransformOutput>;
      minify(code: string, options?: JsMinifyOptions): Promise<TransformOutput>;
    };

    declare interface JsMinifyOptions {
      compress?: TerserCompressOptions | boolean;
      format?: JsFormatOptions & ToSnakeCaseProperties<JsFormatOptions>;
      mangle?: TerserMangleOptions | boolean;
      ecma?: TerserEcmaVersion;
      keep_classnames?: boolean;
      keep_fnames?: boolean;
      module?: boolean | 'unknown';
      safari10?: boolean;
      toplevel?: boolean;
      sourceMap?: boolean;
      outputPath?: string;
      inlineSourcesContent?: boolean;
    }

    declare interface TransformOptions {
      filename?: string;
      sourceMaps?: boolean;
      jsc?: {
        parser?: {
          syntax?: 'ecmascript' | 'typescript';
          decorators?: boolean;
          dynamicImport?: boolean;
          exportDefaultFrom?: boolean;
          exportNamespaceFrom?: boolean;
          importAssertions?: boolean;
          tsx?: boolean;
        };
        target?: string;
        loose?: boolean;
        externalHelpers?: boolean;
        keepClassNames?: boolean;
        keepFnName?: boolean;
        minifySyntax?: boolean;
        minifyWhitespace?: boolean;
        minifyIdentifiers?: boolean;
      };
      // ...
    }

    declare interface TransformOutput {
      code: string;
      map?: string;
    }
  }
}
```
