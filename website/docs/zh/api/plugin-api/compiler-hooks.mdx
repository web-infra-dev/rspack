import CompilerType from '../../types/compiler.mdx';
import StatsType from '../../types/stats.mdx';
import { Collapse, CollapsePanel } from '@components/Collapse';

# Compiler 钩子

## `environment`

`SyncHook<[]>`

在编译器准备环境时，初始化插件之后调用。

## `afterEnvironment`

`SyncHook<[]>`

当编译器环境准备完成后，在 `environment` 钩子后直接调用。

## `afterPlugins`

`SyncHook<[Compiler]>`

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

在初始化内部插件完成之后调用。

## `afterResolvers`

`SyncHook<[Compiler]>`

resolver 设置完成之后触发。

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

## `entryOption`

`SyncBailHook<[string, EntryNormalized]>`

在处理完入口配置后调用。

<Collapse>
  <CollapsePanel header="EntryNormalized.ts" key="EntryNormalized">
    详见 [Entry 配置](/config/entry)
  </CollapsePanel>
</Collapse>

## `initialize`

`SyncHook<[]>`

当编译器被初始化时调用。

## `beforeRun`

`AsyncSeriesHook<[Compiler]>`

在开始执行一次构建之前调用。

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

## `run`

`AsyncSeriesHook<[Compiler]>`

在开始执行一次构建时调用。

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

## `childCompiler`

`SyncHook[Compiler, string, number]`

> 最低版本要求为 `>=0.4.1`.

当创建好一个 childCompiler 后执行。

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

## `watchRun`

`AsyncSeriesHook<[Compiler]>`

在监听模式下，开始执行一次构建时调用。

<Collapse>
  <CollapsePanel
    className="collapse-code-panel"
    header="Compiler.ts"
    key="Compiler"
  >
    <CompilerType />
  </CollapsePanel>
</Collapse>

## `compile`

`SyncHook<[]>`

在一个新的 compilation 创建之前调用。

## `beforeCompile`

`AsyncSeriesHook<[]>`

在编译参数创建后执行插件。

## `afterCompile`

`AsyncSeriesHook<[Compilation]>`

在完成并封闭(seal)编译后调用。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `thisCompilation`

`SyncHook<[Compilation]>`

创建 compilation 时调用，在触发 compilation 钩子之前调用。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `compilation`

`SyncHook<[Compilation]>`

compilation 创建之后执行。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `make`

`AsyncParallelHook<[Compilation]>`

make 阶段之前调用。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `shouldEmit`

`SyncBailHook<[Compilation]>`

> 最低版本要求为 `>=0.4.1`.

返回值为一个布尔值，用于决定是否将资源写入到磁盘中。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `emit`

`AsyncSeriesHook<[Compilation]>`

输出产物之前执行。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `afterEmit`

`AsyncSeriesHook<[Compilation]>`

输出产物之后执行。

<Collapse>
  <CollapsePanel header="Compilation.ts" key="Compilation">
    详见 [Compilation 对象](/api/objects/compilation)
  </CollapsePanel>
</Collapse>

## `done`

`AsyncSeriesHook<Stats>`

<Collapse>
  <CollapsePanel className="collapse-code-panel" header="Stats.ts" key="Stats">
    <StatsType />
  </CollapsePanel>
</Collapse>

在构建完成时执行。

## `afterDone`

`AsyncSeriesHook<Stats>`

在构建完成后，`done` 钩子调用之后执行。

<Collapse>
  <CollapsePanel className="collapse-code-panel" header="Stats.ts" key="Stats">
    <StatsType />
  </CollapsePanel>
</Collapse>

## `watchClose`

`SyncHook<[]>`

在监听模式下，compilation 停止时调用。

## `failed`

`SyncHook<[Error]>`

在构建失败时调用。
