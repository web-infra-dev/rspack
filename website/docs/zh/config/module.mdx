import { ApiMeta } from '../../../components/ApiMeta';

# Module

æ¨¡å—ï¼šè¯¥é€‰é¡¹ç”¨äºå†³å®šå¦‚ä½•å¤„ç†ä¸€ä¸ªé¡¹ç›®ä¸­ä¸åŒç±»å‹çš„æ¨¡å—ã€‚

- **ç±»å‹ï¼š** `Object`
- **é»˜è®¤å€¼ï¼š** `{}`

## module.defaultRules

- **ç±»å‹ï¼š** `Rule[]`

åº”ç”¨äºæ¨¡å—çš„é»˜è®¤è§„åˆ™ã€‚

è¯¦è§[æºä»£ç ](https://github.com/web-infra-dev/rspack/blob/main/packages/rspack/src/config/defaults.ts#L364)ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    defaultRules: [
      '...', // ä½¿ç”¨ "..." æ¥å¼•ç”¨ Rspack é»˜è®¤è§„åˆ™
    ],
  },
};
```

## module.noParse

- **ç±»å‹ï¼š** `string | string[] | RegExp | RegExp[] | ((request: string) => boolean)`
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…çš„æ–‡ä»¶ä»£ç ä¸ä¼šè¢« Rspack è½¬æ¢ï¼ŒåŒ…æ‹¬ `module.exports`, `require`, `import` è¿™äº›æ¨¡å—ç³»ç»Ÿç›¸å…³çš„è¯­æ³•ã€‚

ç”¨æ¥å¿½ç•¥é‚£äº›æ²¡æœ‰å¤–éƒ¨ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™å¾ˆæœ‰ç”¨ï¼Œæœ‰æ—¶è¿˜èƒ½æå‡æ€§èƒ½ã€‚

è¯·æ³¨æ„ï¼šè¿™äº›æ–‡ä»¶ä¾ç„¶è¿˜ä¼šè¢«å·²é…ç½®çš„ loaders å¤„ç†ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    noParse: /typescript|watermark-dom/,
  },
};
```

```js title=rspack.config.js
module.exports = {
  module: {
    noParse: [require.resolve('typescript'), /watermark-dom/],
  },
};
```

```js title=rspack.config.js
module.exports = {
  module: {
    noParse: request => /typescript|watermark-dom/.test(request),
  },
};
```

## module.parser

- **ç±»å‹ï¼š** `Object`
- **é»˜è®¤å€¼ï¼š** `{}`

ä½¿ç”¨ `module.parser` åœ¨ä¸€ä¸ªåœ°æ–¹é…ç½®æ‰€æœ‰è§£æå™¨é€‰é¡¹ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    parser: {
      // asset æ¨¡å—çš„è§£æå™¨é€‰é¡¹
      asset: {
        dataUrlCondition: {
          maxSize: 16192,
        },
      },
      // javascript æ¨¡å—çš„è§£æå™¨é€‰é¡¹
      javascript: {
        dynamicImportMode: 'lazy',
        dynamicImportPrefetch: false,
        dynamicImportPreload: false,
        url: true,
      },
      // CSS æ¨¡å—çš„è§£æå™¨é€‰é¡¹
      css: {
        namedExports: true,
      },
      // css/auto æ¨¡å—çš„è§£æå™¨é€‰é¡¹
      'css/auto': {
        namedExports: true,
      },
      // css/module æ¨¡å—çš„è§£æå™¨é€‰é¡¹
      'css/module': {
        namedExports: true,
      },
    },
  },
};
```

### module.parser.asset

`asset` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ã€‚

#### module.parser.asset.dataUrlCondition

- **ç±»å‹ï¼š** `{ maxSize: number }`
- **é»˜è®¤å€¼ï¼š** `{ maxSize: 8096 }`

å¦‚æœå½“å‰æ¨¡å—çš„å°äºç­‰äº `maxSize`ï¼Œé‚£ä¹ˆæ¨¡å—å°†è¢« Base64 ç¼–ç ï¼Œå¦åˆ™æ¨¡å—å°†ä¼šä»¥æ–‡ä»¶å½¢å¼è¢«è¾“å‡ºã€‚è¯¥é€‰é¡¹ä»…èƒ½åšç”¨äº Asset Module çš„åœºæ™¯ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    parser: {
      asset: {
        dataUrlCondition: {
          // å°äºç­‰äº 4kbï¼Œä¸”ä»¥ `.png` ç»“å°¾çš„æ¨¡å—å°†è¢« Base64 ç¼–ç 
          maxSize: 4 * 1024,
        },
      },
    },
  },
};
```

### module.parser.javascript

`javascript` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ã€‚

#### module.parser.javascript.dynamicImportMode

- **ç±»å‹ï¼š** `'lazy' | 'eager'`
- **é»˜è®¤å€¼ï¼š** `'lazy'`

æŒ‡å®šåŠ¨æ€å¯¼å…¥çš„å…¨å±€æ¨¡å¼ã€‚

#### module.parser.javascript.dynamicImportPrefetch

<ApiMeta addedVersion="0.4.5" />

- **ç±»å‹ï¼š** `boolean | number`
- **é»˜è®¤å€¼ï¼š** `false`

æŒ‡å®šåŠ¨æ€å¯¼å…¥çš„å…¨å±€ prefetchã€‚

#### module.parser.javascript.dynamicImportPreload

<ApiMeta addedVersion="0.4.5" />

æŒ‡å®šåŠ¨æ€å¯¼å…¥çš„å…¨å±€ preloadã€‚

- **ç±»å‹ï¼š** `boolean | number`
- **é»˜è®¤å€¼ï¼š** `false`

#### module.parser.javascript.url

<ApiMeta addedVersion="0.4.4" />

- **ç±»å‹ï¼š** `true | false | 'relative'`
- **é»˜è®¤å€¼ï¼š** `true`

å¯ç”¨ `new URL()` è¯­æ³•è§£æã€‚

å½“ä½¿ç”¨ 'relative' æ—¶ï¼Œwebpack å°†ä¸º `new URL()` è¯­æ³•ç”Ÿæˆç›¸å¯¹çš„ URLï¼Œå³ç»“æœ URL ä¸­ä¸åŒ…å«æ ¹ URL

```html
<!-- ä½¿ç”¨ 'relative' -->
<img src="icon.svg" />

<!-- ä¸ä½¿ç”¨ 'relative' -->
<img src="file:///path/to/project/dist/icon.svg" />
```

#### module.parser.javascript.exprContextCritical

<ApiMeta addedVersion="0.6.3" />

- **ç±»å‹ï¼š** `boolean | undefined`
- **é»˜è®¤å€¼ï¼š** `true`

å¯ç”¨å®Œå…¨åŠ¨æ€ä¾èµ–ï¼ˆ`import(variable)`ï¼‰çš„è­¦å‘Šã€‚

#### module.parser.javascript.wrappedContextCritical

<ApiMeta addedVersion="0.6.3" />

- **ç±»å‹ï¼š** `boolean | undefined`
- **é»˜è®¤å€¼ï¼š** `false`

å¯ç”¨éƒ¨åˆ†åŠ¨æ€ä¾èµ–ï¼ˆ`import("./path/to/" + variable)`ï¼‰çš„è­¦å‘Šã€‚

#### module.parser.javascript.exportsPresence

<ApiMeta addedVersion="0.7.1" />

- **ç±»å‹ï¼š** `"error" | "warn" | "auto" | false`
- **é»˜è®¤å€¼ï¼š** `"auto"`

å½“ä½¿ç”¨äº†ä¸å­˜åœ¨çš„å¯¼å‡ºæˆ–å­˜åœ¨å†²çªçš„é‡å¯¼å‡ºæ—¶ï¼Œæ˜¯å¦è¿›è¡Œè­¦å‘Šæˆ–æŠ¥é”™ã€‚

- `"error"`ï¼šè¿›è¡ŒæŠ¥é”™ã€‚
- `"warn"`ï¼šè¿›è¡Œè­¦å‘Šã€‚
- `"auto"`ï¼šæ ¹æ®æ¨¡å—æ˜¯å¦ä¸ºä¸¥æ ¼ ESMï¼Œå¦‚æœæ˜¯ä¸¥æ ¼ ESM åˆ™æŠ¥é”™ï¼Œå¦åˆ™è­¦å‘Šã€‚
- `false`ï¼šå…³é—­è¯¥åŠŸèƒ½ã€‚

#### module.parser.javascript.importExportsPresence

<ApiMeta addedVersion="0.7.1" />

- **ç±»å‹ï¼š** `"error" | "warn" | "auto" | false`

å½“ä½¿ç”¨äº†ä¸å­˜åœ¨çš„å¯¼å‡ºæ—¶ï¼Œæ˜¯å¦è¿›è¡Œè­¦å‘Šæˆ–æŠ¥é”™ã€‚é»˜è®¤ä¼šéµå¾ª `module.parser.javascript.exportsPresence` çš„é…ç½®ã€‚

#### module.parser.javascript.reexportExportsPresence

<ApiMeta addedVersion="0.7.1" />

- **ç±»å‹ï¼š** `"error" | "warn" | "auto" | false`

å½“ä½¿ç”¨äº†å­˜åœ¨å†²çªçš„é‡å¯¼å‡ºæ—¶ï¼Œæ˜¯å¦è¿›è¡Œè­¦å‘Šæˆ–æŠ¥é”™ã€‚é»˜è®¤ä¼šéµå¾ª `module.parser.javascript.exportsPresence` çš„é…ç½®ã€‚

#### module.parser.javascript.worker

<ApiMeta addedVersion="1.0.0-alpha.0" />

- **ç±»å‹ï¼š** `string[] | boolean`

ä¸º Worker è§£ææä¾›è‡ªå®šä¹‰çš„è¯­æ³•ï¼Œå¸¸ç”¨äºæ”¯æŒ Workletï¼š

```js
module.exports = {
  module: {
    parser: {
      javascript: {
        worker: [
          // æ”¯æŒ CSS paintWorklet
          'CSS.paintWorklet.addModule()',
          // æ”¯æŒ AudioWorkletï¼Œæœ€å‰é¢çš„ '*' è¡¨ç¤ºè¯†åˆ«åä¸º 'context' çš„å˜é‡ï¼Œæ¯”å¦‚ï¼š
          // let context = new AudioContext();
          // await context.audioWorklet.addModule(new URL("noise-processor.js", import.meta.url));
          '*context.audioWorklet.addModule()',
          // ç»§æ‰¿é»˜è®¤è¯­æ³•ï¼š["Worker", "SharedWorker", "navigator.serviceWorker.register()", "Worker from worker_threads"]
          '...',
        ],
      },
    },
  },
};
```

### module.parser["javascript/auto"]

<ApiMeta addedVersion="0.6.3" />

`javascript/auto` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ï¼Œå’Œ [`javascript` çš„æ¨¡å—çš„è§£æå™¨é€‰é¡¹](#moduleparserjavascript)ç›¸åŒã€‚

### module.parser["javascript/dynamic"]

<ApiMeta addedVersion="0.6.3" />

`javascript/dynamic` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ï¼Œå’Œ [`javascript` çš„æ¨¡å—çš„è§£æå™¨é€‰é¡¹](#moduleparserjavascript)ç›¸åŒã€‚

### module.parser["javascript/esm"]

<ApiMeta addedVersion="0.6.3" />

`javascript/esm` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ï¼Œå’Œ [`javascript` çš„æ¨¡å—çš„è§£æå™¨é€‰é¡¹](#moduleparserjavascript)ç›¸åŒã€‚

### module.parser["css/auto"]

`css/auto` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.parser["css/auto"].namedExports

<ApiMeta addedVersion="0.6.0" />

- **ç±»å‹ï¼š** `boolean`
- **é»˜è®¤å€¼ï¼š** `true`

ä½¿ç”¨ ES æ¨¡å—å‘½åå¯¼å‡ºæ¥å¯¼å‡º CSSã€‚

å½“ä½¿ç”¨ `namedExports: true` æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å‘½åç©ºé—´å¯¼å‡ºæˆ–å‘½åå¯¼å‡ºï¼š

```js
// å‘½åç©ºé—´å¯¼å‡º
import * as classes from './index.module.css';
// å‘½åå¯¼å‡º
import { class1, class2 } from './index.module.css';
```

å½“ä½¿ç”¨ `namedExports: false` æ—¶ï¼Œé™¤äº†å‘½åç©ºé—´å¯¼å‡ºå’Œå‘½åå¯¼å‡ºä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨é»˜è®¤å¯¼å‡ºï¼š

```js
// å‘½åç©ºé—´å¯¼å‡º
import * as classes from './index.module.css';
// å‘½åå¯¼å‡º
import { class1, class2 } from './index.module.css';
// é»˜è®¤å¯¼å‡º
import classes from './index.module.css';
// é»˜è®¤å¯¼å‡ºå’Œå‘½åå¯¼å‡º
import classes, { class1, class2 } from './index.module.css';
```

### module.parser.css

`css` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.parser.css.namedExports

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.parser["css/auto"].namedExports`](#moduleparsercssautonamedexports) ä¸€æ ·ã€‚

### module.parser["css/module"]

`css/module` æ¨¡å—çš„è§£æå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.parser["css/module"].namedExports

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.parser["css/auto"].namedExports`](#moduleparsercssautonamedexports) ä¸€æ ·ã€‚

## module.generator

- **ç±»å‹ï¼š** `Object`
- **é»˜è®¤å€¼ï¼š** `{}`

ä½¿ç”¨ `module.generator` åœ¨ä¸€ä¸ªåœ°æ–¹é…ç½®æ‰€æœ‰ç”Ÿæˆå™¨é€‰é¡¹ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    generator: {
      // asset æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      asset: {
        dataUrl: {
          encoding: false,
          mimetype: 'base64',
        },
        filename: '[name]-[contenthash][ext]',
        publicPath: 'https://cdn.example.com/',
      },
      // asset/inline æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      'asset/inline': {
        dataUrl: {
          encoding: false,
          mimetype: 'base64',
        },
      },
      // asset/resource æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      'asset/resource': {
        filename: '[name]-[contenthash][ext]',
        publicPath: 'https://cdn.example.com/',
      },
      // css/auto æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      'css/auto': {
        exportsConvention: 'as-is',
        exportsOnly: false,
        localIdentName: '[uniqueName]-[id]-[local]',
        esModule: true,
      },
      // `css` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      css: {
        exportsOnly: false,
        esModule: true,
      },
      // css/module æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹
      'css/module': {
        exportsConvention: 'as-is',
        exportsOnly: false,
        localIdentName: '[uniqueName]-[id]-[local]',
        esModule: true,
      },
    },
  },
};
```

### module.generator.asset

`asset` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

#### module.generator.asset.dataUrl

- **ç±»å‹ï¼š** `Object | (options: { content: string, filename: string }) => string`
- **é»˜è®¤å€¼ï¼š** `{}`

ä»…å¯¹æ¨¡å—ç±»å‹ä¸º `asset` æˆ– `'asset/inline'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    generator: {
      asset: {
        dataUrl: {
          encoding: 'base64',
          mimetype: 'mimetype/png',
        },
      },
    },
  },
};
```

å½“è¢«ä½œä¸ºä¸€ä¸ªå‡½æ•°ä½¿ç”¨ï¼Œå®ƒå¿…é¡»ä¸ºæ¯ä¸ªæ¨¡å—æ‰§è¡Œä¸”å¹¶é¡»è¿”å›ä¸€ä¸ª data URI å­—ç¬¦ä¸²ã€‚

```js title=rspack.config.js
module.exports = {
  //...
  module: {
    generator: {
      asset: {
        dataUrl: ({ content }) => {
          const svgToMiniDataURI = require('mini-svg-data-uri');
          return svgToMiniDataURI(content);
        },
      },
    },
  },
};
```

##### module.generator.asset.dataUrl.encoding

- **ç±»å‹ï¼š** `false | 'base64'`
- **é»˜è®¤å€¼ï¼š** `'base64'`

è®¾ç½®ä¸º base64 æ—¶ï¼Œæ¨¡å—å°†ä½¿ç”¨ base64 ç®—æ³•è¿›è¡Œç¼–ç ã€‚å°†ç¼–ç è®¾ç½®ä¸º false å°†ç¦ç”¨ç¼–ç ã€‚ä»…å¯¹æ¨¡å—ç±»å‹ä¸º `'asset/inline'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

##### module.generator.asset.dataUrl.mimetype

- **ç±»å‹ï¼š** `string`
- **é»˜è®¤å€¼ï¼š** `require('mime-types').lookup(ext)`

dataUrl çš„ MIME ç±»å‹ï¼Œé»˜è®¤ä»æ¨¡å—èµ„æºæ‰©å±•åè§£æã€‚ä»…å¯¹æ¨¡å—ç±»å‹ä¸º `'asset/inline'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

#### module.generator.asset.filename

- **ç±»å‹ï¼š** `string`
- **é»˜è®¤å€¼ï¼š** `undefined`
- **æ”¯æŒçš„ Template stringï¼š** å‚è€ƒ [`output.assetModuleFilename`](/config/output#outputassetmodulefilename)

è¦†ç›– [`output.assetModuleFilename`](/config/output#outputassetmodulefilename)ï¼Œä»…å¯¹æ¨¡å—ç±»å‹ä¸º `'asset'` å’Œ `'asset/resource'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

```ts title=rspack.config.js
module.exports = {
  module: {
    generator: {
      asset: {
        filename: 'static/[hash][ext]',
      },
    },
  },
};
```

#### module.generator.asset.publicPath

- **ç±»å‹ï¼š** `string`
- **é»˜è®¤å€¼ï¼š** `undefined`

è¦†ç›– [`output.publicPath`](/config/output#outputpublicpath)ï¼Œä»…å¯¹æ¨¡å—ç±»å‹ä¸º `'asset'` å’Œ `'asset/resource'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

```ts title=rspack.config.js
module.exports = {
  module: {
    generator: {
      asset: {
        publicPath: 'https://cdn.example.com/',
      },
    },
  },
};
```

#### module.generator.asset.emit

- **ç±»å‹ï¼š** `boolean`
- **é»˜è®¤å€¼ï¼š** `true`

æ˜¯å¦å°† asset è¾“å‡ºåˆ°ç£ç›˜ã€‚å¯¹äº SSR ç­‰åœºæ™¯ï¼Œä½ å¯ä»¥å°†è¯¥é€‰é¡¹è®¾ç½®ä¸º `false` æ¥é¿å…è¾“å‡ºæ— ç”¨çš„æ–‡ä»¶ã€‚

ä»…å¯¹æ¨¡å—ç±»å‹ä¸º `'asset'` æˆ– `'asset/resource'` çš„æ¨¡å—ç”Ÿæ•ˆã€‚

- `'asset'`ï¼š

```js title=rspack.config.js
module.exports = {
  module: {
    generator: {
      asset: {
        emit: false,
      },
    },
  },
};
```

- `'asset/resource'`ï¼š

```js title=rspack.config.js
module.exports = {
  module: {
    generator: {
      'asset/resource': {
        emit: false,
      },
    },
  },
};
```

### module.generator["asset/inline"]

`asset/inline` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

#### module.generator["asset/inline"].dataUrl

å’Œ [`module.generator["asset"].dataUrl`](#modulegeneratorassetdataurl) ä¸€æ ·ã€‚

##### module.generator["asset/inline"].dataUrl.encoding

å’Œ [`module.generator["asset"].dataUrl.encoding`](#modulegeneratorassetdataurlencoding) ä¸€æ ·ã€‚

##### module.generator["asset/inline"].dataUrl.mimetype

å’Œ [`module.generator["asset"].dataUrl.mimetype`](#modulegeneratorassetdataurlmimetype) ä¸€æ ·ã€‚

### module.generator["asset/resource"]

`asset/resource` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

#### module.generator["asset/resource"].filename

å’Œ [`module.generator["asset"].filename`](#modulegeneratorassetfilename) ä¸€æ ·ã€‚

#### module.generator["asset/resource"].publicPath

å’Œ [`module.generator["asset"].publicPath`](#modulegeneratorassetpublicpath) ä¸€æ ·ã€‚

### module.generator["css/auto"]

`css/auto` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.generator["css/auto"].exportsConvention

<ApiMeta addedVersion="0.6.0" />

- **ç±»å‹ï¼š** `'as-is' | 'camel-case' | 'camel-case-only' | 'dashes' | 'dashes-only'`
- **é»˜è®¤å€¼ï¼š** `'as-is'`

è‡ªå®šä¹‰ CSS å¯¼å‡ºåç§°å¦‚ä½•å¯¼å‡ºåˆ° JavaScript æ¨¡å—ï¼Œä¾‹å¦‚ä¿ç•™åŸæ ·ã€è½¬æ¢ä¸ºé©¼å³°å‘½åç­‰ç­‰ã€‚

#### module.generator["css/auto"].exportsOnly

<ApiMeta addedVersion="0.6.0" />

- **ç±»å‹ï¼š** `boolean`
- **é»˜è®¤å€¼ï¼š** `true` for node environments, `false` for web environments.

å¦‚æœä¸º `true`ï¼Œä»…ä» CSS ä¸­å¯¼å‡ºæ ‡è¯†ç¬¦æ˜ å°„è¡¨åˆ° JavaScript æ–‡ä»¶ä¸­ï¼Œè€Œä¸åœ¨ template ä¸­æ³¨å…¥ä»»ä½• stylesheetsã€‚é€‚ç”¨äºä½¿ç”¨ CSS Modules è¿›è¡Œé¢„æ¸²æŸ“çš„åœºæ™¯ï¼ˆä¾‹å¦‚ SSRï¼‰ã€‚

å¦‚æœä¸º `false`ï¼Œç”Ÿæˆ stylesheets å¹¶å°†å…¶æ³¨å…¥åˆ° template ä¸­ã€‚

#### module.generator["css/auto"].localIdentName

<ApiMeta addedVersion="0.6.0" />

- **ç±»å‹ï¼š** `string`
- **é»˜è®¤å€¼ï¼š** `[uniqueName]-[id]-[local]`

è‡ªå®šä¹‰ç”Ÿæˆçš„ CSS Modules çš„å±€éƒ¨ç±»åæ ¼å¼ï¼Œé™¤äº†åœ¨[æ–‡ä»¶çº§åˆ«](/config/output#file-context)å’Œ[æ¨¡å—çº§åˆ«](/config/output#module-context)çš„æ›¿æ¢ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ `[uniqueName]` å’Œ `[local]`ã€‚

#### module.generator["css/auto"].esModule

<ApiMeta addedVersion="0.6.4" />

- **ç±»å‹ï¼š** `boolean`
- **é»˜è®¤å€¼ï¼š** `true`

æ˜¯å¦ä¸º CSS çš„å¯¼å‡ºæ·»åŠ  `__esModule`ï¼Œå¦‚æœæ·»åŠ åˆ™ä¼šåœ¨ esm-cjs interop æ—¶å½“ä½œ ES Moduleï¼Œå¦åˆ™å½“ä½œ CommonJS Moduleã€‚

æ¯”å¦‚åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶åº“çš„ cjs äº§ç‰©æ—¶ï¼Œæœ‰æ—¶éœ€è¦æ·»åŠ è¯¥é…ç½®ç¡®ä¿ esm-cjs interop æ­£ç¡®ï¼Œä»¥æ‹¿åˆ°æ­£ç¡®çš„å¯¼å‡ºï¼ˆå¯é…åˆ [Rule.test](#ruletest) ç­‰åŒ¹é…æ¡ä»¶åªä¸ºè¯¥ç»„ä»¶åº“æ·»åŠ ï¼‰ã€‚

ç»„ä»¶åº“æºç ï¼š

```js
import style from './style.css';
export function Button() {
  return <button className={style.btn}></button>;
}
```

ç»„ä»¶åº“å‘å¸ƒçš„ cjs äº§ç‰©ï¼š

```js
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true,
});
exports.Button = Button;
var _style = _interopRequireDefault(require('./style.css'));
var _jsxRuntime = require('react/jsx-runtime');
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}
function Button() {
  return /*#__PURE__*/ (0, _jsxRuntime.jsx)('button', {
    className: _style['default'].btn, // <-- æ³¨æ„ï¼šè¿™é‡Œç»è¿‡ _interopRequireDefault åéœ€è¦è®¿é—® default
  });
}
```

### module.generator.css

`css` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.generator.css.exportsConvention

<ApiMeta addedVersion="0.6.0" removedVersion="0.7.0" />

å’Œ [`module.generator["css/auto"].exportsConvention`](#modulegeneratorcssautoexportsconvention) ä¸€æ ·ã€‚

#### module.generator.css.exportsOnly

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.generator["css/auto"].exportsOnly`](#modulegeneratorcssautoexportsonly) ä¸€æ ·ã€‚

#### module.generator.css.esModule

<ApiMeta addedVersion="0.6.4" />

å’Œ [`module.generator["css/auto"].esModule`](#modulegeneratorcssautoesmodule) ä¸€æ ·ã€‚

### module.generator["css/module"]

`css/module` æ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

:::warning
åªæœ‰åœ¨ `experiments.css = true` æ—¶è¯¥é…ç½®æ‰ä¼šç”Ÿæ•ˆ
:::

#### module.generator["css/module"].exportsConvention

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.generator["css/auto"].exportsConvention`](#modulegeneratorcssautoexportsconvention) ä¸€æ ·ã€‚

#### module.generator["css/module"].exportsOnly

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.generator["css/auto"].exportsOnly`](#modulegeneratorcssautoexportsonly) ä¸€æ ·ã€‚

#### module.generator["css/module"].localIdentName

<ApiMeta addedVersion="0.6.0" />

å’Œ [`module.generator["css/auto"].localIdentName`](#modulegeneratorcssautolocalidentname) ä¸€æ ·ã€‚

#### module.generator["css/module"].esModule

<ApiMeta addedVersion="0.6.4" />

å’Œ [`module.generator["css/auto"].esModule`](#modulegeneratorcssautoesmodule) ä¸€æ ·ã€‚

## module.rules

- **ç±»å‹ï¼š** `Rule[]`
- **é»˜è®¤å€¼ï¼š** `[]`

ä¸€ä¸ªè§„åˆ™æ•°ç»„ï¼Œå½“æ¨¡å—è¢«åˆ›å»ºæ—¶ä¸è¯¥æ¨¡å—çš„è¯·æ±‚ç›¸åŒ¹é…ã€‚è¿™äº›è§„åˆ™å¯ä»¥ä¿®æ”¹æ¨¡å—çš„åˆ›å»ºè¡Œä¸ºã€‚å®ƒä»¬å¯ä»¥å¯¹æ¨¡å—åº”ç”¨ Loader ç­‰ã€‚

### Rule

- **ç±»å‹ï¼š** `Rule`
- **é»˜è®¤å€¼ï¼š** `{}`

Rule å®šä¹‰äº†ä¸€ä¸ªæ¨¡å—çš„åŒ¹é…æ¡ä»¶ä»¥åŠå¤„ç†è¿™äº›æ¨¡å—çš„è¡Œä¸ºã€‚

**Rule å¤„ç†è¡Œä¸º**

å®šä¹‰äº†å¯¹åº”åŒ¹é…çš„æ¨¡å—çš„å¤„ç†è¡Œä¸ºï¼Œä¾‹å¦‚:

- å°† Loader çš„åˆ—è¡¨åº”ç”¨åˆ°è¿™äº›æ¨¡å—ä¸Šï¼ˆ`Rule.use`ï¼‰
- å®šä¹‰æ¨¡å—çš„ç±»å‹ï¼ˆ`Rule.type`ï¼‰
- å®šä¹‰æ¨¡å—çš„ resolve é…ç½®ï¼ˆ`Rule.resolve`ï¼‰

#### Condition

- **ç±»å‹ï¼š** `string | RegExp | Condition[] | LogicalConditions`

å®šä¹‰äº†ä¸€ä¸ªæ¨¡å—çš„åŒ¹é…æ¡ä»¶ï¼Œå¸¸è§çš„åŒ¹é…æœ‰å’Œ `resource` ä¸ `resourceQuery` çš„åŒ¹é…ï¼Œä»¥åŠ `include` ä¸ `exclude` çš„åŒ¹é…ç­‰ã€‚

ä¾‹å¦‚: å½“ app.js å¯¼å…¥ `./image.png?inline#foo`

- `resource` ä¸º `/path/to/image.png`ï¼Œä¼šä¸ `Rule.resource` è¿™ä¸ª Condition è¿›è¡ŒåŒ¹é…
- `resourceQuery` ä¸º `?inline`ï¼Œä¼šä¸ `Rule.resourceQuery` è¿™ä¸ª Condition è¿›è¡ŒåŒ¹é…
- `resourceFragment` ä¸º `#foo`ï¼Œä¼šä¸ `Rule.resourceFragment` è¿™ä¸ª Condition è¿›è¡ŒåŒ¹é…

Condition ä»£è¡¨äº†åŒ¹é…ä¸€ä¸ªç»™å®šè¾“å…¥çš„å½¢å¼ï¼Œå®ƒæ”¯æŒçš„ç±»å‹ä¸ºï¼š

- `String`ï¼šç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œå½“è¾“å…¥çš„å­—ç¬¦ä¸²æ»¡è¶³ `startsWith` æ—¶ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚æ³¨ï¼šä½ å¯ä»¥è®¤ä¸ºæ˜¯ `input.startsWith(condition)`ã€‚
- `RegExp`ï¼šç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œå½“è¾“å…¥çš„å­—ç¬¦ä¸²æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚æ³¨ï¼šä½ å¯ä»¥è®¤ä¸ºæ˜¯ `condition.test(input)`ã€‚
- `Condition[]`ï¼šä¸€ç³»åˆ—æ¡ä»¶ï¼Œå½“æœ‰ä¸€ä¸ªæ¡ä»¶åŒ¹é…ä¸Šæ—¶ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚
- `LogicalConditions`ï¼šæ‰€æœ‰å±æ€§éƒ½åŒ¹é…ä¸Šæ—¶ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚
  - `{ and: Condition[] }`ï¼šæ‰€æœ‰æ¡ä»¶éƒ½åŒ¹é…ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚
  - `{ or: Condition[] }`ï¼šå…¶ä¸­ä¸€ä¸ªæ¡ä»¶åŒ¹é…ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚
  - `{ not: Condition }`ï¼šæ‰€æœ‰æ¡ä»¶éƒ½ä¸åŒ¹é…æ—¶ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚
- `(value: string) => boolean`ï¼šå½“è¾“å…¥çš„å­—ç¬¦ä¸²ç»å‡½æ•°è°ƒç”¨åè¿”å› true æ˜¯ï¼Œåˆ™åŒ¹é…æˆåŠŸã€‚

#### Nested Rule

åµŒå¥— Rule å¯ä»¥é€šè¿‡ [`Rule.rules`](#rulerules) å’Œ [`Rule.oneOf`](#ruleoneof) å®šä¹‰ï¼Œè¿™äº›åµŒå¥— Rule åªæœ‰åœ¨å…¶ä¸Šå±‚ Rule åŒ¹é…æˆåŠŸæ—¶æ‰ä¼šè¿›è¡ŒåŒ¹é…ï¼Œå®ƒä»¬å¯ä»¥åŒ…å«è‡ªå·±çš„ Rule æ¡ä»¶

åµŒå¥— Rule çš„åŒ¹é…é¡ºåºï¼š

1. å…¶ä¸Šå±‚ Rule
2. [`Rule.rules`](#rulerules)
3. [`Rule.oneOf`](#ruleoneof)

### Rule.exclude

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

æ’é™¤æ‰€æœ‰ç¬¦åˆè¿™ä¸ªæ¡ä»¶çš„æ¨¡å—ï¼Œä¼šå’Œèµ„æºçš„ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å« query å’Œ fragmentï¼‰è¿›è¡ŒåŒ¹é…ã€‚è¯¥é€‰é¡¹ä¸èƒ½å’Œ `Rule.resource` åŒæ—¶å­˜åœ¨ã€‚

### Rule.include

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªæ¡ä»¶çš„æ¨¡å—ï¼Œä¼šå’Œèµ„æºçš„ç»å¯¹è·¯å¾„ï¼ˆä¸åŒ…å« query å’Œ fragmentï¼‰è¿›è¡ŒåŒ¹é…ã€‚è¯¥é€‰é¡¹ä¸èƒ½å’Œ `Rule.resource` åŒæ—¶å­˜åœ¨ã€‚

### Rule.resource

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resourceï¼ˆä¸åŒ…å« query å’Œ fragment çš„ç»å¯¹è·¯å¾„ï¼‰è¿›è¡ŒåŒ¹é…ã€‚è¯¥é€‰é¡¹ä¸èƒ½å’Œ `Rule.test` åŒæ—¶å­˜åœ¨ã€‚

### Rule.resourceQuery

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resource çš„ query è¿›è¡ŒåŒ¹é…ã€‚æ³¨ï¼šåŒ…å« `?`ï¼Œå½“ `Rule.resourceQuery` ä¸º `?raw` æ—¶ï¼Œä¼šå’Œ `foo?raw` çš„èµ„æºè¯·æ±‚è¿›è¡ŒåŒ¹é…ã€‚

### Rule.resourceFragment

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resource çš„ fragment è¿›è¡ŒåŒ¹é…ã€‚æ³¨ï¼šåŒ…å« `#`ï¼Œå½“ `Rule.resourceFragment` ä¸º `#abc` æ—¶ï¼Œä¼šå’Œ `foo#abc` çš„èµ„æºè¯·æ±‚è¿›è¡ŒåŒ¹é…ã€‚

### Rule.test

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resourceï¼ˆä¸åŒ…å« query å’Œ fragment çš„ç»å¯¹è·¯å¾„ï¼‰è¿›è¡ŒåŒ¹é…ã€‚è¯¥é€‰é¡¹ä¸èƒ½å’Œ `Rule.resource` åŒæ—¶å­˜åœ¨ã€‚

### Rule.issuer

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œå¼•å…¥å½“å‰æ¨¡å—çš„æ¨¡å—çš„ Resourceï¼ˆä¸åŒ…å« query å’Œ fragment çš„ç»å¯¹è·¯å¾„ï¼‰è¿›è¡ŒåŒ¹é…ã€‚

### Rule.dependency

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œå¼•å…¥å½“å‰æ¨¡å—çš„ä¾èµ–çš„ç±»åˆ«ï¼ˆcategoryï¼‰è¿›è¡ŒåŒ¹é…ï¼Œæ¯”å¦‚å¯¹äº `import`ã€`import()` æ¥è¯´æ˜¯ `esm`ï¼Œå¯¹äº `require()` æ¥è¯´æ˜¯ `cjs`ï¼Œå¯¹äº `new URL()`ã€`url()` æ¥è¯´æ˜¯ `url`ã€‚

### Rule.scheme

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resource çš„ scheme è¿›è¡ŒåŒ¹é…ã€‚

æ¯”å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®å°†å†…è”çš„ data uri èµ„æºå½“ä½œå•ç‹¬çš„èµ„æºå¤„ç†ï¼š

```js title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        scheme: 'data',
        type: 'asset/resource',
      },
    ],
  },
};
```

### Rule.mimetype

- **ç±»å‹ï¼š** [`Condition`](/config/module#condition)
- **é»˜è®¤å€¼ï¼š** `undefined`

åŒ¹é…æ‰€æœ‰ç¬¦åˆè¿™ä¸ªèµ„æºçš„æ¨¡å—ï¼Œä¼šå’Œ Resource çš„ mimetype è¿›è¡ŒåŒ¹é…ã€‚

### Rule.descriptionData

- **ç±»å‹ï¼š** `{ [key: string]: Condition }`
- **é»˜è®¤å€¼ï¼š** `undefined`

`descriptionData` é€‰é¡¹å…è®¸ä½ é€šè¿‡åŒ¹é…æè¿°æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `package.json`ï¼‰ä¸­çš„å±æ€§å€¼ï¼Œæ¥å†³å®šæŸä¸ª rule åº”è¯¥åº”ç”¨äºå“ªäº›æ¨¡å—ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäº `package.json` æ¥åº”ç”¨ rule çš„å®ç”¨æ–¹æ³•ã€‚

`descriptionData` å¯¹è±¡ä¸­çš„ key å¯¹åº”æ¨¡å—çš„ `package.json` ä¸­çš„é”®ï¼Œä¾‹å¦‚ `name`ã€`version` ç­‰ã€‚æ¯ä¸ª key ä¸ä¸€ä¸ªç”¨äºåŒ¹é… `package.json` æ•°æ®çš„ [`Condition`](/config/module#condition) è¿›è¡Œå…³è”ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢çš„é…ç½®ä¼šå°† rule åº”ç”¨äº `package.json` çš„ `name` ä¸­åŒ…å« `'rspack'` å­—ç¬¦ä¸²çš„ JavaScript èµ„æºã€‚

```ts title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        include: /node_modules/,
        descriptionData: {
          name: packageJsonName => packageJsonName.includes('rspack'),
        },
        // å…¶ä»– rule options...
      },
    ],
  },
};
```

### Rule.loaders

:::warning

è¿™ä¸ªé€‰é¡¹å·²ç»è¢«åºŸå¼ƒï¼Œè¯·ä½¿ç”¨ `Rule.use` ä»£æ›¿ã€‚

:::

### Rule.loader

`Rule.loader` æ˜¯ `Rule.use: [ { loader } ]` çš„ç®€ç•¥å†™æ³•ã€‚ è¯¦æƒ…è§ [Rule.use](/config/module#ruleuse).

### Rule.options

`Rule.options` æ˜¯ `Rule.use: [ { options } ]` çš„ç®€ç•¥å†™æ³•ã€‚ è¯¦æƒ…è§ [Rule.use](/config/module#ruleuse).

### Rule.parser

- **ç±»å‹ï¼š** `Object`
- **é»˜è®¤å€¼ï¼š** `{}`

å¯¹äºé€šè¿‡è§„åˆ™æ¡ä»¶åŒ¹é…çš„ç‰¹å®šæ¨¡å—çš„è§£æå™¨é€‰é¡¹ï¼Œè¿™å°†è¦†ç›– `module.parser` ä¸­çš„è§£æå™¨é€‰é¡¹ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.css/,
        parser: {
          namedExports: false,
        },
        type: 'css/module',
      },
    ],
  },
};
```

å¯¹äºç‰¹å®šçš„è§£æå™¨é€‰é¡¹åŠå…¶å¯¹åº”çš„æ¨¡å—ç±»å‹ï¼Œä½ å¯ä»¥å‚è€ƒ [`module.parser`](#moduleparser)ã€‚

### Rule.generator

- **ç±»å‹ï¼š** `Object`
- **é»˜è®¤å€¼ï¼š** `{}`

å¯¹äºé€šè¿‡è§„åˆ™æ¡ä»¶åŒ¹é…çš„ç‰¹å®šæ¨¡å—çš„ç”Ÿæˆå™¨é€‰é¡¹ï¼Œè¿™å°†è¦†ç›– `module.generator` ä¸­çš„ç”Ÿæˆå™¨é€‰é¡¹ã€‚

```js title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.png/,
        generator: {
          filename: '[contenthash][ext]',
        },
        type: 'asset',
      },
    ],
  },
};
```

å¯¹äºç‰¹å®šçš„ç”Ÿæˆå™¨é€‰é¡¹åŠå…¶å¯¹åº”çš„æ¨¡å—ç±»å‹ï¼Œä½ å¯ä»¥å‚è€ƒ [`module.generator`](#modulegenerator)ã€‚

### Rule.sideEffects

- **ç±»å‹ï¼š** `boolean`

æ ‡è®°æ¨¡å—æ˜¯å¦å­˜åœ¨å‰¯ä½œç”¨ã€‚

### Rule.type

- **ç±»å‹ï¼š** `'javascript/auto' | 'typescript' | 'css' | 'css/module' | 'css/auto' | 'json' | 'asset' | 'asset/source' | 'asset/resource' | 'asset/inline' | 'tsx' | 'jsx'`

ç”¨äºæ ‡è®°åŒ¹é…çš„æ¨¡å—çš„ç±»å‹ï¼Œè¿™ä¼šå½±å“ Rspack å†…ç½®å¯¹äºè¯¥æ¨¡å—çš„å¤„ç†æ–¹å¼ã€‚ä¾‹å¦‚ï¼šå½“æ¨¡å—è¢«æ ‡è®°ä¸º `'typescript'` åˆ™ä¼šä½¿ç”¨ TS parser/generator å¯¹æ¨¡å—è¿›è¡Œå¤„ç†ã€‚

- `'javascript/auto'`ï¼šJavaScript æ¨¡å—ï¼Œæ”¯æŒçš„æ¨¡å—ç³»ç»Ÿï¼šCommonJSã€ESMï¼Œæš‚æ²¡æœ‰å¯¹ AMD æ¨¡å—æ”¯æŒçš„è®¡åˆ’ã€‚
- `'javascript/esm'`ï¼šJavaScript æ¨¡å—ï¼Œå½“ä½œä¸¥æ ¼ ES Module å¤„ç†ã€‚
- `'javascript/dynamic'`ï¼šJavaScript æ¨¡å—ï¼Œå½“ä½œ Script å¤„ç†ã€‚
- `'jsx'`: æ”¯æŒ JSX çš„ JavaScript æ¨¡å—ï¼ˆğŸš§ å·²åºŸå¼ƒï¼Œè¯¦è§ [experiments.rspackFuture.disableTransformByDefault](/config/experiments#experimentsrspackfuturedisabletransformbydefault)ï¼‰ã€‚
- `'typescript'`ï¼šTypeScript æ¨¡å—ï¼ˆğŸš§ å·²åºŸå¼ƒï¼‰ã€‚
- `'tsx'`: æ”¯æŒ TSX çš„ TypeScript æ¨¡å—ï¼ˆğŸš§ å·²åºŸå¼ƒï¼‰ã€‚
- `'css'`ï¼šCSS æ¨¡å—ã€‚
- `'css/module'`ï¼šCSS Modules æ¨¡å—ã€‚
- `'css/auto'`ï¼šåŸºäºæ–‡ä»¶ååˆ¤æ–­ï¼Œè‹¥åŒ¹é…`/\.module(s)?\.[^.]+$/`åˆ™ä¸º CSS Modules æ¨¡å—ï¼Œå¦åˆ™ä¸º CSS æ¨¡å—ã€‚
- `'json'`ï¼šJSON data æ¨¡å—ã€‚
- `'asset' | 'asset/source' | 'asset/resource' | 'asset/inline'`ï¼šå‚è€ƒ[èµ„æºæ¨¡å—](/guide/features/asset-module)ã€‚

### Rule.use

- **ç±»å‹ï¼š**

```ts
export type RuleSetUse =
  | RuleSetUseItem[]
  | RuleSetUseItem
  | ((ctx: RawFuncUseCtx) => RuleSetUseItem[]);
export type RuleSetUseItem =
  | { loader: string; options: Record<string, any> }
  | string;
export interface RawFuncUseCtx {
  resource?: string;
  realResource?: string;
  resourceQuery?: string;
  issuer?: string;
}
```

ç”¨äºä¼ é€’ Loader åŒ…åä¸å…¶é€‰é¡¹çš„æ•°ç»„ã€‚`string[]` å¦‚: `use: ['svgr-loader']` æ˜¯ `use: [ { loader: 'svgr-loader' } ]` çš„ç®€å†™ã€‚Loader ä¼šæŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºæ‰§è¡Œã€‚

```ts title=rspack.config.js
module.exports = {
  //...
  module: {
    rules: [
      {
        //...
        use: [
          'svgr-loader',
          {
            loader: 'svgo-loader',
            options: {
              configFile: false,
            },
          },
        ],
      },
    ],
  },
};
```

ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼š

```ts title=rspack.config.js
module.exports = {
  //...
  module: {
    rules: [
      {
        test: /\.svg$/,
        type: 'asset',
        use: info => ({
          loader: 'svgo-loader',
          options: {
            plugins: [
              {
                cleanupIDs: { prefix: basename(info.resource) },
              },
            ],
          },
        }),
      },
    ],
  },
};
```

### Rule.resolve

æ ¹æ®åŒ¹é…çš„æ¨¡å—è®¾ç½®å…·ä½“çš„æ¨¡å— resolve é€‰é¡¹
{
//TODO: æ·»åŠ  link åˆ° resolve
}

```ts title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        resolve: {
          preferRelative: true,
        },
      },
    ],
  },
};
```

### Rule.rules

- **ç±»å‹ï¼š** <code>[Rule](#rule)[]</code>
- **é»˜è®¤å€¼ï¼š** `undefined`

[åµŒå¥— Rule](#nested-rule) çš„ä¸€ç§ï¼Œå½“å…¶ä¸Šå±‚ [Rule](#rule) åŒ¹é…æˆåŠŸåä¼šä½¿ç”¨è¿™äº› Rule è¿›è¡ŒåŒ¹é…

### Rule.oneOf

- **ç±»å‹ï¼š** <code>[Rule](#rule)[]</code>
- **é»˜è®¤å€¼ï¼š** `undefined`

[åµŒå¥— Rule](#nested-rule) çš„ä¸€ç§ï¼Œå½“å…¶ä¸Šå±‚ Rule åŒ¹é…æˆåŠŸåä¼šä½¿ç”¨è¿™äº› Rule è¿›è¡ŒåŒ¹é…ï¼Œå¹¶ä¸”åªä½¿ç”¨åŒ¹é…æˆåŠŸçš„ç¬¬ä¸€ä¸ª Rule
