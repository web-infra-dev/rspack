import { PackageManagerTabs } from '@theme';

# CSS

CSS æ˜¯ Rspack çš„ä¸€ç­‰å…¬æ°‘ï¼ŒRspack å†…ç½®äº†å¤šç§èƒ½åŠ›æ¥æ”¯æŒ CSS æ‰“åŒ…ã€‚

## å¼€å¯ CSS æ”¯æŒ

ä½ å¯ä»¥ä»ä»¥ä¸‹æ–¹å¼ä¸­è¿›è¡Œé€‰æ‹©ï¼š

### åŸç”Ÿ CSS æ”¯æŒ

Rspack æä¾›äº† [experiment.css](/config/experiments#experimentscss) é€‰é¡¹ï¼Œè¿™æ˜¯ä» webpack 5 å¼€å§‹å¼•å…¥çš„å®éªŒæ€§åŠŸèƒ½ï¼Œç”¨äºå¼€å¯ CSS åŸç”Ÿæ”¯æŒã€‚Rspack è¿›ä¸€æ­¥å®Œå–„äº†è¯¥åŠŸèƒ½ï¼Œå¹¶è®¡åˆ’åœ¨ Rspack 2.0 é»˜è®¤å¼€å¯å®ƒã€‚

> å¦‚æœä½ åŸºäº Rspack åˆ›å»ºäº†ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨è¯¥æ–¹å¼ã€‚

```js title="rspack.config.js"
module.exports = {
  experiments: {
    css: true,
  },
};
```

å¼€å¯ `experiment.css` åï¼ŒRspack å°†æ”¯æŒä»¥ä¸‹ä¸‰ç§æ¨¡å—ç±»å‹ï¼Œä½ å¯ä»¥åœ¨ `rule` ä¸Šé€šè¿‡ `type` æ¥è®¾ç½®å®ƒä»¬ï¼š

- `css`ï¼šç”¨äºå¤„ç†æ™®é€šçš„ CSS æ–‡ä»¶ã€‚
- `css/module`ï¼šç”¨äºå¤„ç† [CSS Modules](https://github.com/css-modules/css-modules)ã€‚
- `css/auto`ï¼šåŸºäºæ–‡ä»¶æ‰©å±•åè‡ªåŠ¨åˆ¤æ–­æ˜¯æ™®é€š CSS æ–‡ä»¶è¿˜æ˜¯ CSS Modulesï¼Œ`*.module.css` ç»“å°¾çš„æ–‡ä»¶è§†ä¸º CSS Modulesã€‚

å¯¹äº `*.css` ç»“å°¾çš„æ–‡ä»¶ï¼ŒRspack ä¼šé»˜è®¤å°†å…¶è§†ä¸º `type: 'css/auto'`ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡é…ç½® `type: 'css/auto'`ï¼Œè‡ªå®šä¹‰å°†å“ªäº›æ–‡ä»¶è§†ä¸º CSS æ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œå°† `.less` æ–‡ä»¶è§†ä¸º CSS æ–‡ä»¶ï¼š

```js title=rspack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.less$/,
        type: 'css/auto', // ğŸ‘ˆ
        use: ['less-loader'],
      },
    ],
  },
};
```

### ä½¿ç”¨ CssExtractRspackPlugin

Rspack æ”¯æŒä½¿ç”¨ [css-loader](https://github.com/webpack-contrib/css-loader) å’Œ [CssExtractRspackPlugin](/plugins/rspack/css-extract-rspack-plugin)ï¼Œç”¨äºç”Ÿæˆç‹¬ç«‹çš„ CSS æ–‡ä»¶ã€‚

å¦‚æœä½ æ­£åœ¨è¿ç§»ä¸€ä¸ªä½¿ç”¨ [mini-css-extract-plugin](https://github.com/webpack-contrib/mini-css-extract-plugin) çš„ webpack é¡¹ç›®ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ CssExtractRspackPlugin æ¥æ›¿æ¢ mini-css-extract-pluginï¼Œå®ƒä»¬çš„åŠŸèƒ½å’Œé…ç½®æ–¹å¼åŸºæœ¬ä¸€è‡´ã€‚

- å®‰è£… css-loaderï¼š

<PackageManagerTabs command="add css-loader -D" />

- æ·»åŠ é…ç½®ï¼š

```js title="rspack.config.js"
const rspack = require('@rspack/core');

module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/i,
        use: [rspack.CssExtractRspackPlugin.loader, 'css-loader'],
        type: 'javascript/auto',
      },
    ],
  },
  plugins: [new rspack.CssExtractRspackPlugin({})],
};
```

> å‚è€ƒ [è¿ç§»æŒ‡å—](/guide/migration/webpack#mini-css-extract-plugin--rspackcssextractrspackplugin) äº†è§£å¦‚ä½•ä» webpack è¿›è¡Œè¿ç§»ã€‚

:::tip
CssExtractRspackPlugin ä¸èƒ½ä¸ `type: 'css'`ã€`type: 'css/auto'` æˆ– `type: 'css/module'` åŒæ—¶ä½¿ç”¨ï¼Œå› ä¸ºè¿™äº› type æ˜¯ç”± `experiments.css` æä¾›çš„ã€‚
:::

### ä½¿ç”¨ style-loader

Rspack æ”¯æŒä½¿ç”¨ [css-loader](https://github.com/webpack-contrib/css-loader) å’Œ [style-loader](https://github.com/webpack-contrib/style-loader)ï¼Œå°† CSS é€šè¿‡ `<style>` æ ‡ç­¾æ³¨å…¥ã€‚è¿™ç§æ–¹å¼ä¸ä¼šç”Ÿæˆç‹¬ç«‹çš„ CSS æ–‡ä»¶ï¼Œè€Œæ˜¯å°† CSS çš„å†…å®¹å†…è”åˆ° JS æ–‡ä»¶ä¸­ã€‚

- å®‰è£… css-loader å’Œ style-loaderï¼š

<PackageManagerTabs command="add css-loader style-loader -D" />

- æ·»åŠ é…ç½®ï¼š

```js title="rspack.config.js"
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/i,
        use: ['style-loader', 'css-loader'],
        type: 'javascript/auto',
      },
    ],
  },
};
```

:::tip
style-loader ä¸èƒ½ä¸ `type: 'css'`ã€`type: 'css/auto'` æˆ– `type: 'css/module'` åŒæ—¶ä½¿ç”¨ï¼Œå› ä¸ºè¿™äº› type æ˜¯ç”± `experiments.css` æä¾›çš„ã€‚
:::

## CSS Modules

Rspack é»˜è®¤å°†æ‰©å±•åä¸º `*.module.css` çš„æ–‡ä»¶è§†ä¸º [CSS Modules](https://github.com/css-modules/css-modules)ï¼Œä½ å¯ä»¥åœ¨ JavaScript æ–‡ä»¶ä¸­å¯¼å…¥å®ƒï¼Œç„¶åå°† CSS æ–‡ä»¶ä¸­å®šä¹‰çš„æ¯ä¸ªç±»ä½œä¸ºæ¨¡å—çš„å¯¼å‡ºæ¥è®¿é—®ã€‚

```css title="index.module.css"
.red {
  color: red;
}
```

ä½ å¯ä»¥ä½¿ç”¨å‘½åç©ºé—´å¯¼å…¥ï¼š

```ts title="index.js"
import * as styles from './index.module.css';
document.getElementById('element').className = styles.red;
```

ä¹Ÿå¯ä»¥ä½¿ç”¨å…·åå¯¼å…¥ï¼š

```ts
import { red } from './index.module.css';
document.getElementById('element').className = red;
```

è¦åœ¨ Rspack ä¸­å¯ç”¨é»˜è®¤å¯¼å…¥æ–¹å¼ï¼Œä½ éœ€è¦åœ¨ `rspack.config.js` æ–‡ä»¶ä¸­å°† `namedExports` é…ç½®ä¸º `false`ã€‚è¿™å…è®¸ä½ åœ¨ç”¨åˆ° CSS Modules æ—¶ï¼Œé™¤äº†å‘½åç©ºé—´å¯¼å…¥å’Œå…·åå¯¼å…¥ï¼Œä¹Ÿèƒ½é€šè¿‡é»˜è®¤å¯¼å…¥æ•´ä¸ªæ ·å¼æ¨¡å—ï¼š

```js title=rspack.config.js
module.exports = {
  module: {
    parser: {
      'css/auto': {
        namedExports: false,
      },
    },
  },
};
```

ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨é»˜è®¤å¯¼å…¥ï¼š

```js
import styles from './index.module.css';
document.getElementById('element').className = styles.red;
```

æ›´å¤šå…³äº CSS Modules çš„é…ç½®è¯·å‚è€ƒ [module.parser.css](/config/module#moduleparsercss)ã€‚

## PostCSS

Rspack æ”¯æŒä½¿ç”¨ [postcss-loader](https://github.com/webpack-contrib/postcss-loader)ï¼Œä½ å¯ä»¥è¿™æ ·é…ç½®ï¼š

<PackageManagerTabs command="add postcss postcss-loader -D" />

```ts title="rspack.config.js"
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          {
            loader: 'postcss-loader',
            options: {
              postcssOptions: {
                // ...
              },
            },
          },
        ],
        // å¦‚æœä½ éœ€è¦å°† '*.module.css' è§†ä¸º CSS Modules é‚£ä¹ˆå°† 'type' è®¾ç½®ä¸º 'css/auto' å¦åˆ™è®¾ç½®ä¸º 'css'
        type: 'css/auto',
      },
    ],
  },
};
```

ä¸Šè¿°é…ç½®ä¼šå°†æ‰€æœ‰ `*.css` æ–‡ä»¶ç»è¿‡ [postcss-loader](https://github.com/webpack-contrib/postcss-loader) å¤„ç†ï¼Œå¹¶å°†ç”Ÿæˆçš„ç»“æœäº¤ç»™ Rspack å®Œæˆ CSS åç»­æµç¨‹çš„å¤„ç†ã€‚

## Sass

Rspack æ”¯æŒä½¿ç”¨ [sass-loader](https://github.com/webpack-contrib/sass-loader)ï¼Œä½ å¯ä»¥è¿™æ ·é…ç½®ï¼š

<PackageManagerTabs command="add sass-embedded sass-loader -D" />

```ts title="rspack.config.js"
module.exports = {
  module: {
    rules: [
      {
        test: /\.(sass|scss)$/,
        use: [
          {
            loader: 'sass-loader',
            options: {
              // åŒæ—¶ä½¿ç”¨ `modern-compiler` å’Œ `sass-embedded` å¯ä»¥æ˜¾è‘—æå‡æ„å»ºæ€§èƒ½
              // éœ€è¦ `sass-loader >= 14.2.1`
              api: 'modern-compiler',
              implementation: require.resolve('sass-embedded'),
            },
          },
        ],
        // å¦‚æœä½ éœ€è¦å°† '*.module.(sass|scss)' è§†ä¸º CSS Modules é‚£ä¹ˆå°† 'type' è®¾ç½®ä¸º 'css/auto' å¦åˆ™è®¾ç½®ä¸º 'css'
        type: 'css/auto',
      },
    ],
  },
};
```

ä¸Šè¿°é…ç½®ä¼šå°†æ‰€æœ‰ `*.sass` å’Œ `*.scss` æ–‡ä»¶ç»è¿‡ [sass-loader](https://github.com/webpack-contrib/sass-loader) å¤„ç†ï¼Œå¹¶å°†ç”Ÿæˆçš„ç»“æœäº¤ç»™ Rspack å®Œæˆ CSS åç»­æµç¨‹çš„å¤„ç†ã€‚

## Less

Rspack æ”¯æŒä½¿ç”¨ [less-loader](https://github.com/webpack-contrib/less-loader)ï¼Œä½ å¯ä»¥è¿™æ ·é…ç½®ï¼š

<PackageManagerTabs command="add less less-loader -D" />

```ts title="rspack.config.js"
module.exports = {
  module: {
    rules: [
      {
        test: /\.less$/,
        use: [
          {
            loader: 'less-loader',
            options: {
              // ...
            },
          },
        ],
        // å¦‚æœä½ éœ€è¦å°† '*.module.less' è§†ä¸º CSS Modules é‚£ä¹ˆå°† 'type' è®¾ç½®ä¸º 'css/auto' å¦åˆ™è®¾ç½®ä¸º 'css'
        type: 'css/auto',
      },
    ],
  },
};
```

ä¸Šè¿°é…ç½®ä¼šå°†æ‰€æœ‰ `*.less` æ–‡ä»¶ç»è¿‡ [less-loader](https://github.com/webpack-contrib/less-loader) å¤„ç†ï¼Œå¹¶å°†ç”Ÿæˆçš„ç»“æœäº¤ç»™ Rspack å®Œæˆ CSS åç»­æµç¨‹çš„å¤„ç†ã€‚

## Tailwind CSS

[Tailwind CSS](https://tailwindcss.com/) æ˜¯ä¸€ä¸ªåŠŸèƒ½ç±»ä¼˜å…ˆçš„ CSS æ¡†æ¶ï¼Œå®ƒé›†æˆäº†ä¸€ç³»åˆ—æ ·å¼ç±»ï¼Œå®ƒä»¬èƒ½ç›´æ¥åœ¨è„šæœ¬æ ‡è®°è¯­è¨€ä¸­ç»„åˆèµ·æ¥ï¼Œæ„å»ºå‡ºä»»ä½•è®¾è®¡ã€‚

å°† Tailwind CSS ä½œä¸º PostCSS æ’ä»¶å®‰è£…ï¼Œæ˜¯å°†å…¶ä¸ Rspack æ•´åˆçš„æœ€ä½³æ–¹å¼ã€‚

### å®‰è£… Tailwind CSS

åœ¨ä½ çš„é¡¹ç›®ä¸­å®‰è£… [tailwindcss](https://tailwindcss.com/)ã€[autoprefixer](https://github.com/postcss/autoprefixer)ã€[postcss](https://postcss.org/) å’Œ [postcss-loader](https://www.npmjs.com/package/postcss-loader) è¿™äº›ä¾èµ–ï¼š

<PackageManagerTabs command="add tailwindcss autoprefixer postcss postcss-loader -D" />

### é…ç½® Tailwind CSS

å®‰è£…å®Œæˆåï¼Œä½ éœ€è¦åœ¨ `rspack.config.js` ä¸­é…ç½® `postcss-loader` æ¥å¤„ç† CSS æ–‡ä»¶ï¼Œç„¶ååœ¨ `postcssOptions.plugins` ä¸­æ·»åŠ  `tailwindcss`ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªå¤„ç† `.css` æ–‡ä»¶çš„é…ç½®ç¤ºä¾‹ï¼Œå¦‚æœä½ éœ€è¦å¤„ç† `.scss` æˆ– `.less` æ–‡ä»¶ï¼Œå¯ä»¥å‚è€ƒè¯¥ç¤ºä¾‹è¿›è¡Œä¿®æ”¹ã€‚

```ts title="rspack.config.js"
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          {
            loader: 'postcss-loader',
            options: {
              postcssOptions: {
                plugins: {
                  tailwindcss: {},
                  autoprefixer: {},
                },
              },
            },
          },
        ],
        type: 'css',
      },
    ],
  },
};
```

åˆ°æ­¤ä¸ºæ­¢ï¼Œä½ å·²ç»å®Œæˆäº†åœ¨ Rspack ä¸­ä½¿ç”¨ Tailwind CSS æ‰€éœ€çš„æ„å»ºé…ç½®ã€‚

æ¥ä¸‹æ¥ä½ å¯ä»¥æŒ‰ç…§ [Tailwind CSS å®˜æ–¹æ–‡æ¡£](https://tailwindcss.com/docs/installation/using-postcss)ä¸­çš„æ­¥éª¤ï¼Œæ·»åŠ  Tailwind CSS æ‰€éœ€çš„é…ç½®å’Œä»£ç ï¼Œå³å¯å¼€å§‹ä½¿ç”¨ã€‚
