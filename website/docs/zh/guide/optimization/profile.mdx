import { Stability } from '@components/ApiMeta.tsx';

# æ€§èƒ½åˆ†æž

æœ¬ç« èŠ‚ä»‹ç» Rspack ä¸­ä¸€äº›å¸¸è§çš„æ€§èƒ½ç“¶é¢ˆå’Œæ€§èƒ½åˆ†æžæ–¹æ³•ã€‚

## æ€§èƒ½ç“¶é¢ˆ

å°½ç®¡ Rspack æœ¬èº«æä¾›çš„æž„å»ºæ€§èƒ½å·²ç»è¶³å¤Ÿä¼˜ç§€ï¼Œä½†åœ¨ Rspack ä¸­ä½¿ç”¨ä¸€äº› JavaScript ç¼–å†™çš„ loaders å’Œ plugins æ—¶ï¼Œå®ƒä»¬å¯èƒ½ä¼šå¯¼è‡´æ•´ä½“çš„æž„å»ºæ€§èƒ½åŠ£åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨å¤§åž‹é¡¹ç›®ä¸­ã€‚

å¯¹äºŽè¿™ç±»é—®é¢˜ï¼Œæœ‰ä¸€éƒ¨åˆ†å¯ä»¥é€šè¿‡ Rspack å†…ç½®çš„é«˜æ€§èƒ½æ›¿ä»£æ–¹æ¡ˆæ¥è§£å†³ï¼Œå¦ä¸€éƒ¨åˆ†å¯ä»¥é€šè¿‡æ€§èƒ½åˆ†æžå·¥å…·æ¥å®šä½ï¼Œä»Žè€Œé‡‡å–é’ˆå¯¹æ€§çš„ä¼˜åŒ–ã€‚

ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„æ¡ˆä¾‹ï¼š

### babel-loader

[babel-loader](https://github.com/babel/babel-loader) åŸºäºŽ Babel æ¥ç¼–è¯‘ JavaScript å’Œ TypeScript ä»£ç ï¼Œå¯ä»¥å°† Babel æ›¿æ¢ä¸ºæ›´å¿«çš„ SWCã€‚Rspack å†…ç½®äº† [builtin:swc-loader](/guide/features/builtin-swc-loader)ï¼Œå®ƒæ˜¯ `swc-loader` çš„ Rust ç‰ˆæœ¬ï¼Œæ—¨åœ¨æä¾›æ›´ä¼˜çš„æ€§èƒ½ã€‚

å¦‚æžœä½ éœ€è¦ä½¿ç”¨ Babel æ’ä»¶å®žçŽ°è‡ªå®šä¹‰çš„è½¬æ¢é€»è¾‘ï¼Œå¯ä»¥åœ¨é…ç½® babel-loader æ—¶ä½¿ç”¨ [Rule.include](/config/module#ruleinclude) æ¥åŒ¹é…å°½å¯èƒ½å°‘çš„æ–‡ä»¶ï¼Œä»¥å‡å°‘ Babel ç¼–è¯‘çš„å¼€é”€ã€‚

### postcss-loader

[postcss-loader](https://github.com/postcss/postcss-loader) åŸºäºŽ PostCSS æ¥ç¼–è¯‘ CSS ä»£ç ï¼Œé€šå¸¸ä¼šé…åˆ PostCSS æ’ä»¶è¿›è¡Œ CSS è¯­æ³•é™çº§ã€æ·»åŠ æµè§ˆå™¨å‰ç¼€ç­‰ï¼Œå¯ä»¥å°† PostCSS æ›¿æ¢ä¸ºæ›´å¿«çš„ Lightning CSSï¼Œä½¿ç”¨ Rspack å†…ç½®çš„ [builtin:lightningcss-loader](/guide/features/builtin-lightningcss-loader) å³å¯ã€‚

å¦‚æžœé¡¹ç›®é‡Œä½¿ç”¨äº† Tailwind CSS v3 çš„ PostCSS æ’ä»¶ï¼Œåˆ™éœ€è¦ç­‰å¾… Tailwind CSS v4 ç‰ˆæœ¬å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬åŸºäºŽ Rust å’Œ Lightning CSS å®žçŽ°ï¼Œæ€§èƒ½ä¼šæœ‰æ˜¾è‘—æå‡ï¼Œè¯¦è§ [Open-sourcing our progress on Tailwind CSS v4.0](https://tailwindcss.com/blog/tailwindcss-v4-alpha)ã€‚

### terser-webpack-plugin

[terser-webpack-plugin](https://github.com/webpack-contrib/terser-webpack-plugin) åŸºäºŽ Terser æ¥åŽ‹ç¼© JavaScript ä»£ç ï¼Œå¯ä»¥å°† Terser æ›¿æ¢ä¸ºæ›´å¿«çš„ SWC minimizerï¼Œä½¿ç”¨ Rspack å†…ç½®çš„ [SwcJsMinimizerRspackPlugin](/plugins/rspack/swc-js-minimizer-rspack-plugin) å³å¯ã€‚

### css-minimizer-webpack-plugin

[css-minimizer-webpack-plugin](https://github.com/webpack-contrib/css-minimizer-webpack-plugin) åŸºäºŽ cssnano ç­‰åŽ‹ç¼©å·¥å…·æ¥åŽ‹ç¼© CSS ä»£ç ï¼Œå¯ä»¥å°† cssnano æ›¿æ¢ä¸ºæ›´å¿«çš„ Lightning CSS minimizerï¼Œä½¿ç”¨ Rspack å†…ç½®çš„ [LightningCssMinimizerRspackPlugin](/plugins/rspack/lightning-css-minimizer-rspack-plugin) å³å¯ã€‚

### less-loader

[less-loader](https://github.com/webpack-contrib/less-loader) åŸºäºŽ Less æ¥ç¼–è¯‘ `.less` æ–‡ä»¶ï¼Œç”±äºŽ Less ç›®å‰æ²¡æœ‰å®˜æ–¹å®žçŽ°çš„é«˜æ€§èƒ½æ›¿ä»£æ–¹æ¡ˆï¼Œå»ºè®®ä½¿ç”¨ [sass-loader](https://github.com/webpack-contrib/sass-loader) å’Œ [sass-embedded](https://www.npmjs.com/package/sass-embedded) ä»£æ›¿ï¼Œsass-embedded æ˜¯ Sass åŽŸç”Ÿ Dart å¯æ‰§è¡Œæ–‡ä»¶çš„ JavaScript wrapperï¼Œå…·å¤‡å‡ºè‰²çš„æ€§èƒ½ã€‚

### html-webpack-plugin

[html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin) åœ¨ç”Ÿæˆå¤§é‡ HTML æ–‡ä»¶æ—¶ï¼Œæ€§èƒ½è¡¨çŽ°ä¸ä½³ï¼ŒRspack åŸºäºŽ Rust å®žçŽ°çš„ [HtmlRspackPlugin](/plugins/rspack/html-rspack-plugin) å¯ä»¥æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚

## Rspack Profile

Rspack CLI æ”¯æŒä½¿ç”¨ `RSPACK_PROFILE` çŽ¯å¢ƒå˜é‡æ¥è¿›è¡Œæž„å»ºæ€§èƒ½åˆ†æžã€‚

```sh
$ RSPACK_PROFILE=ALL rspack build
```

æ‰§è¡Œè¯¥å‘½ä»¤åŽä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª `.rspack-profile-${timestamp}-${pid}` æ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹ä¼šåŒ…å« `logging.json`ã€`trace.json` å’Œ `jscpuprofile.json` ä¸‰ä¸ªæ–‡ä»¶

- `trace.json`ï¼šä½¿ç”¨ [tracing](https://github.com/tokio-rs/tracing) ç»†ç²’åº¦åœ°è®°å½•äº† Rust ä¾§å„ä¸ªé˜¶æ®µçš„è€—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ [ui.perfetto.dev](https://ui.perfetto.dev/) è¿›è¡ŒæŸ¥çœ‹
- `jscpuprofile.json`ï¼šä½¿ç”¨ [Node.js inspector](https://nodejs.org/dist/latest-v18.x/docs/api/inspector.html) ç»†ç²’åº¦åœ°è®°å½•äº† JavaScript ä¾§çš„å„ä¸ªé˜¶æ®µçš„è€—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ [speedscope.app](https://www.speedscope.app/) è¿›è¡ŒæŸ¥çœ‹
- `logging.json`ï¼šåŒ…å«ä¸€äº›æ—¥å¿—ä¿¡æ¯ï¼Œç²—ç²’åº¦åœ°è®°å½•äº†æž„å»ºçš„å„ä¸ªé˜¶æ®µè€—æ—¶

## Rsdoctor çš„ç¼–è¯‘åˆ†æž

ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ Rsdoctor æ¥æŸ¥çœ‹ Loader å’Œ Plugin çš„ç¼–è¯‘è€—æ—¶åŠç¼–è¯‘è¿‡ç¨‹ã€‚

#### Loader Timeline

å¦‚æžœæƒ³è¦åˆ†æž Loader å’Œ Plugin è€—æ—¶æˆ–è€… Loader çš„ç¼–è¯‘è¡Œä¸ºï¼Œå¯ä»¥åˆ©ç”¨ Rsdoctor æ¥æŸ¥çœ‹ï¼š

![image](https://assets.rspack.dev/others/assets/rsdoctor/rsdoctor-loader-timeline.png)

æ‚¨å¯ä»¥åœ¨æ—¶é—´è½´ä¸­æŸ¥çœ‹æ¯ä¸ª Loader çš„æ‰§è¡Œæ—¶é—´ä»¥åŠç¼–è¯‘çš„æ–‡ä»¶ï¼Œä»¥åŠè¿™ä¸ª Loader ç¼–è¯‘æ–‡ä»¶æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚

å‚è€ƒ [Loader Timeline](https://rsdoctor.dev/guide/usage/loaders-timeline).

#### Loader Details

å¦‚æžœä½ æƒ³æŸ¥çœ‹ Loader å¯¹ä»£ç ç¼–è¯‘è¿‡ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ [Loader Details](https://rsdoctor.dev/guide/usage/loaders-analysis) åŠŸèƒ½:

![image](https://assets.rspack.dev/others/assets/rsdoctor/rsdoctor-analyze-code.png)

åœ¨è¿™ä¸ªæŠ¥å‘Šé¡µé¢ä¸­ï¼Œä½ å¯ä»¥æŸ¥çœ‹åˆ° Loader å¯¹æ¯ä¸ªæ–‡ä»¶çš„ç¼–è¯‘å‰åŽçš„ä»£ç çš„å˜åŒ–ã€‚

å‚è€ƒ [Loader Details](https://rsdoctor.dev/guide/usage/loaders-analysis).

#### å¼€å¯ç¼–è¯‘è€—æ—¶åˆ†æž

å…³äºŽå¦‚ä½•å¯ç”¨ `RsdoctorRspackPlugin`ï¼Œå¯ä»¥å‚è€ƒ [ä½¿ç”¨ Rsdoctor](/guide/optimization/use-rsdoctor)ã€‚

- `RsdoctorRspackPlugin` çš„ `features.loader` å’Œ `features.plugins` å‚æ•°éœ€è¦ä¸º `true`ï¼Œ`features.loader` å’Œ `features.plugins` æ˜¯é»˜è®¤å¼€å¯çš„ã€‚æŸ¥çœ‹å‚æ•°æ–‡æ¡£[Rsdoctor options](https://rsdoctor.dev/zh/config/options/options#features)ã€‚
- ä½¿ç”¨æ–‡æ¡£ï¼š
  - Loader Analysis ä½¿ç”¨æ–‡æ¡£å¯æŸ¥çœ‹ [Loader Timeline](https://rsdoctor.dev/zh/guide/usage/loaders-timeline) å’Œ [Loader Details](https://rsdoctor.dev/zh/guide/usage/loaders-analysis)ã€‚
  - Plugins Analysis ä½¿ç”¨æ–‡æ¡£å¯æŸ¥çœ‹ [Plugin Analysis](https://rsdoctor.dev/zh/guide/usage/plugins-analysis)ã€‚

#### ðŸ“¢ æ³¨æ„

**CssExtractRspackPlugin çš„ loader è€—æ—¶è¿‡é•¿é—®é¢˜**

åœ¨ä½¿ç”¨ Rsdoctor å¯¹ Rspack é¡¹ç›®è¿›è¡Œç¼–è¯‘è€—æ—¶åˆ†æžæ—¶ï¼Œå¯èƒ½ä¼šå‘çŽ° [CssExtractRspackPlugin](/plugins/rspack/css-extract-rspack-plugin) çš„ loader è€—æ—¶è¾ƒé•¿ï¼Œè¯¦æƒ…åŠåŽŸå› è¯·æŸ¥çœ‹ï¼š

[> CssExtractRspackPlugin çš„ loader è€—æ—¶è¿‡é•¿é—®é¢˜](https://rsdoctor.dev/zh/guide/more/faq#cssextractrspackplugin-%E7%9A%84-loader-%E8%80%97%E6%97%B6%E8%BF%87%E9%95%BF%E9%97%AE%E9%A2%98)
