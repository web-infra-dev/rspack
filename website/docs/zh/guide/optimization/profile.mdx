import { ApiMeta, Stability } from '@components/ApiMeta.tsx';

# 性能分析

<ApiMeta addedVersion={'0.3.0'} />

Rspack CLI 支持使用 `RSPACK_PROFILE` 环境变量来进行构建性能分析。

```sh
$ RSPACK_PROFILE=ALL rspack build
```

执行该命令后会在当前目录下生成一个 `.rspack-profile-${timestamp}` 文件夹，该文件夹下会包含 `logging.json`、`trace.json` 和 `jscpuprofile.json` 三个文件

- `trace.json`：使用 [tracing](https://github.com/tokio-rs/tracing) 细粒度地记录了 Rust 侧各个阶段的耗时，可以使用 [ui.perfetto.dev](https://ui.perfetto.dev/) 进行查看
- `jscpuprofile.json`：使用 [Node.js inspector](https://nodejs.org/dist/latest-v18.x/docs/api/inspector.html) 细粒度地记录了 JavaScript 侧的各个阶段的耗时，可以使用 [speedscope.app](https://www.speedscope.app/) 进行查看
- `logging.json`：包含一些日志信息，粗粒度地记录了构建的各个阶段耗时
