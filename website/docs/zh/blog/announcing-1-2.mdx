---
date: 2025-1-21 16:00:00
sidebar: false
---

# Rspack 1.2 发布公告

> 2025 年 1 月 21 日

![Rspack 1.2](https://assets.rspack.dev/rspack/rspack-banner-v1-2.png)

> 由 [@jerrykingxyz](https://github.com/jerrykingxyz)，[@chenjiahan](https://github.com/chenjiahan)，[@JSerFeng](https://github.com/JSerFeng)， [@ahabhgk](https://github.com/ahabhgk) 发布

---

Rspack v1.2 已经正式发布！

值得关注的变更如下：

- 新功能
  - [支持持久化缓存](#支持持久化缓存)：实验性功能，让热启动性能提升高达 **250%**
  - [更快的 code splitting 算法](#更快的-code-splitting-算法)：实验性功能，显著提升 code splitting 性能
  - [支持 Yarn PnP](#支持-yarn-pnp)
- 性能优化
  - [Watch 范围变化](#watch-范围变化)：更少的内存开销

## 新功能

### 支持持久化缓存

在 Rspack v1.2 中，我们实验性的支持了持久化缓存，其会将构建中的缓存信息写入到存储介质中，加速下次 Rspack 的启动速度。

```js title=rspack.config.js
module.exports = {
  cache: true,
  experiments: {
    cache: {
      type: 'persistent',
    },
  },
};
```

当构建命中缓存时，它可以在真实项目中带来高达 250% 的性能提升。

| 项目类型                 | 模块数量 | Normal dev | Cold dev     | Hot dev       |
| ------------------------ | -------- | ---------- | ------------ | ------------- |
| 初始项目                 | 26       | 146 ms     | 149 ms (+2%) | 134 ms (-8%)  |
| 包含 10000 个模块的项目  | 10040    | 2.43 s     | 2.43 s (+0%) | 1.16 s (-52%) |
| 包含 Less 文件的中型项目 | 1898     | 3.47 s     | 3.55 s (+2%) | 0.92 s (-73%) |
| 大型真实项目             | 45968    | 93.3 s     | 91.9 s (-1%) | 26 s (-72%)   |

需要注意的是，持久化缓存目前仍处于实验阶段，当前仅支持构建过程中的 make 阶段（包括模块解析、转换等流程）。未来我们将持续优化，进一步提升缓存的性能和覆盖范围。

如果你在使用持久化缓存时遇到任何问题，欢迎通过 GitHub Issues 反馈。

> 详情请参考 [experiments.cache](/config/experiments#experimentscache)。

### 更快的 code splitting 算法

在之前的 Rspack 版本中，code splitting 算法在 HMR 下会占用大量的耗时，在 Rspack v1.2 中，我们实现了全新的 code splitting 算法，它支持多线程，增量构建效率更高。如果你的代码库包含大量动态导入，code splitting 可能会花费大量时间，开启这项新功能可以显著提高 code splitting 的性能。

```js title="rspack.config.js"
module.exports = {
  experiments: {
    parallelCodeSplitting: true,
  },
};
```

> 详情请参考 [experiments.parallelCodeSplitting](/config/experiments#experimentsparallelcodesplitting)。

### 支持 Yarn PnP

Rspack 迎来了对 Yarn PnP 的支持，其默认根据 `process.versions.pnp`（即应用在 Yarn PnP 环境中运行时）来进行开启，也可以将 `resolve.pnp` 配置为 `true` 来强制开启。

```js title="rspack.config.js"
module.exports = {
  resolve: {
    pnp: true,
  },
};
```

> 详情请参考 [resolve.pnp](/config/resolve#resolvepnp)。

## 性能优化

### Watch 范围变化

Rspack v1.2 将不再监听 `node_modules` 和 `.git` 目录下的文件变动，这将显著减少监听的文件数目并带来性能提升。

通过 [benchmark 仓库](https://github.com/rspack-contrib/build-tools-performance) 中的数据，这项调整将：

- 减少内存占用 120MB
- 提升 Dev 启动速度 40%
- 提升 HMR 速度 20~30%

这个变更不会影响 monorepo 中的符号链接资源，因为 Rspack 默认将符号链接资源解析为它的真实路径。

如果你倾向于保持之前行为，可以设置 ：

```js title="rspack.config.js"
module.exports = {
  watchOptions: {
    ignored: [],
  },
};
```

> 详情请参考 [watchOptions.ignored](/config/watch#watchoptionsignored)。

## 升级指南

### 升级 SWC 插件

在 Rspack v1.2 中，Rust 包中 `swc_core` 已升级到 `10.1.0`。SWC Wasm 插件的用户需要确保与正在使用的 `swc_core` 版本一致，否则可能会导致意外问题。

> 详情请参考 [SWC 文档](https://swc.rs/docs/plugin/selecting-swc-core)。

### WarnCaseSensitiveModules 检查默认关闭

[WarnCaseSensitiveModulesPlugin](/plugins/webpack/warn-case-sensitive-modules-plugin) 将检查模块的路径，并对路径全部为小写的冲突模块发出警告。我们过去默认启用它，但由于它只是一个 linter 插件，并且它在开发模式下会产生额外的性能开销。所以现在我们默认禁用它。

如果你倾向于保持之前行为，可以设置：

```js title="rspack.config.js"
module.exports = {
  plugins: [new rspack.WarnCaseSensitiveModulesPlugin()],
};
```
