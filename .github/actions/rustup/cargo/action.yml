name: cargo cache

description: Cache rust dependencies to github or local

inputs:
  key:
    required: true
  save-if:
    default: false
    required: false
    type: boolean

runs:
  using: composite
  steps:
    - name: Cache to github
      if: ${{ runner.environment == 'github-hosted' }}
      uses: Swatinem/rust-cache@779680da715d629ac1d338a641029a2f4372abb5 # v2
      with:
        prefix-key: "RCache-G-2"
        shared-key: ${{ inputs.key }}
        save-if: ${{ inputs.save-if }}

    - name: Cache to local
      uses: stormslowly/rust-cache@9d47c6ad4b02e050fd481d890b2ea34778fd09d6 # v2.7.8
      if: ${{ runner.environment == 'self-hosted' }}
      with:
        prefix-key: "RCache-L-5"
        shared-key: ${{ inputs.key }}
        save-if: ${{ inputs.save-if }}
        fullmatch-only: "true"
